<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Dessiner et afficher des polygones - Madinat Al Irfane</title>

	<!-- Leaflet CSS & JS -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
	<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

	<!-- Leaflet Draw CSS & JS -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css" />
	<script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>

	<style>
		html, body {
			height: 100%;
			margin: 0;
		}
		#map {
			height: 100vh;
			width: 100%;
		}

		/* âœ… Bandeau du haut */
		#banniere-haut {
			position: fixed;
			top: 15px;
			left: 50%;
			transform: translateX(-50%);
			background-color: rgba(255, 255, 255, 0.95);
			padding: 10px 30px;
			border: 2px solid #2e7d32;
			border-radius: 12px;
			font-family: "Segoe UI", Arial, sans-serif;
			font-size: 20px;
			font-weight: bold;
			color: #2e7d32;
			box-shadow: 0 4px 12px rgba(0,0,0,0.2);
			z-index: 10000;
			text-align: center;
		}

		/* âœ… Bandeau du bas */
		#banniere-bas {
			position: fixed;
			bottom: 20px;
			left: 50%;
			transform: translateX(-50%);
			background-color: rgba(255, 255, 255, 0.9);
			padding: 8px 25px;
			border: 2px solid red;
			border-radius: 10px;
			font-family: "Segoe UI", Arial, sans-serif;
			font-size: 18px;
			font-weight: bold;
			color: red;
			box-shadow: 0 4px 10px rgba(0,0,0,0.2);
			z-index: 10000;
			text-align: center;
		}
	</style>
</head>
<body>

	<!-- âœ… Bandeaux fixes -->
	<div id="banniere-haut">
		INSTITUT AGRONOMIQUE ET VÃ‰TÃ‰RINAIRE HASSAN II
	</div>

	<div id="banniere-bas">
		Le site est actuellement en cours d'actualisation
	</div>

	<div id="map"></div>

<script>
	// ðŸ—ºï¸ Initialisation de la carte
	const map = L.map('map').setView([33.9767, -6.8669], 19);

	// --- Fond OpenStreetMap ---
	const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		maxZoom: 19,
		attribution: '&copy; OpenStreetMap contributors'
	});

	// --- Fond Esri Satellite (libre et compatible GitHub) ---
	const esriSat = L.tileLayer(
		'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', 
		{
			maxZoom: 19,
			attribution: '&copy; Esri, Maxar, Earthstar Geographics'
		}
	);

	// âœ… Par dÃ©faut : fond satellite
	esriSat.addTo(map);

	// --- ContrÃ´le des couches ---
	const baseMaps = {
		"Satellite (Esri)": esriSat,
		"OpenStreetMap": osm
	};
	L.control.layers(baseMaps).addTo(map);

	// --- Groupe pour les polygones dessinÃ©s ---
	const drawnItems = new L.FeatureGroup();
	map.addLayer(drawnItems);

	// --- Outils de dessin ---
	const drawControl = new L.Control.Draw({
		edit: { featureGroup: drawnItems },
		draw: {
			polygon: {
				allowIntersection: false,
				showArea: true,
				shapeOptions: { color: 'blue', fillColor: '#3388ff', fillOpacity: 0.6 }
			},
			polyline: false,
			circle: false,
			marker: false,
			rectangle: false,
			circlemarker: false
		}
	});
	map.addControl(drawControl);

	// --- Style unique bleu ---
	const optionsBleu = { color: 'blue', fillColor: '#3388ff', fillOpacity: 0.6 };

	// --- Polygones existants ---
	const polygons = [
		[[33.97679397875895, -6.86682352169535],[33.976676657874926, -6.866629808651174],[33.97659724056922, -6.8666900265637825],[33.97654837044448, -6.86662182796396],[33.97644139189891, -6.866704329717343],[33.976404135392904, -6.86667281376234],[33.97628736116371, -6.866782784328734],[33.97635353324702, -6.8669001309752575],[33.97633462694288, -6.866961151228562],[33.97615946539573, -6.867110684376768],[33.97630626748218, -6.867321908337133],[33.97647480862954, -6.867163065102575],[33.97646424335751, -6.867140936878849],[33.97649649523642, -6.867106738714909],[33.97648982243941, -6.867077234407995],[33.97653208350689, -6.8670396834828855],[33.97655988682931, -6.867030966303842],[33.97660659639005, -6.867083939932532],[33.976654418057066, -6.867167758961796],[33.97672448231132, -6.867105397604024],[33.97669779117403, -6.867056447290934],[33.976774528172285, -6.866977322127308],[33.97671836559341, -6.866890820889108]],
		[[33.975204203633915, -6.865946063716372],[33.97502244340073, -6.8656569068550315],[33.974794695090196, -6.865873444413296],[33.974998354665956, -6.866134873904372]],
		[[33.97610536263391, -6.8667041166518885],[33.97600005669917, -6.866535519262439],[33.97591854862626, -6.866610850010916],[33.97602563950887, -6.866783752014563]],
		[[33.97591840615211, -6.8668900897172325],[33.975799139222296, -6.86671250785883],[33.97571010886983, -6.86679893553136],[33.975818737086094, -6.866974491741187]],
		[[33.9756700093033, -6.86711334159731],[33.97555502929431, -6.8669405837408855],[33.9754627992282, -6.867028074844139],[33.97557839422853, -6.867202315600619]],
		[[33.975428874328614, -6.866990798038492],[33.97531668573446, -6.866818442132075],[33.97522159694376, -6.866908296131446],[33.975334480116224, -6.867081298607847]],
		[[33.975625305776596, -6.866808995552806],[33.97561974505173, -6.866800278373762],[33.97564476831082, -6.8667747973888655],[33.97551297906347, -6.866573631718632],[33.97537118027803, -6.866707742165455],[33.97550853047769, -6.8669176250147315]]
	];

	// --- Ajout des polygones ---
	const allPolygons = polygons.map(coords => L.polygon(coords, optionsBleu).addTo(map));
	allPolygons.forEach(poly => poly.bindPopup("<b>Bienvenue Ã  vos classes !</b>"));

	// --- Ajustement de la vue ---
	map.fitBounds(L.featureGroup(allPolygons).getBounds());

	// --- Dessin manuel ---
	map.on(L.Draw.Event.CREATED, function (e) {
		const layer = e.layer;
		drawnItems.addLayer(layer);
		if (e.layerType === 'polygon') {
			layer.bindPopup("<b>Nouveau polygone dessinÃ© !</b><br>Bienvenue Ã  vos classes !").openPopup();
		}
	});
</script>
</body>
</html>
